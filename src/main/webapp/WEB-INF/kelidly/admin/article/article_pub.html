
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">


<#include "../include/resource.html">
<body>
	<#assign nid="article"> <#assign mid="article_pub"> <#include
	"../include/left.html">


	<div id="main-content">
		<noscript>
			<div class="notification error png_bg">
				<div>很遗憾！您的浏览器不支持JS脚本，无法正常浏览该网页。</div>
			</div>
		</noscript>
		<!-- Page Head -->
		<h2>欢迎进入 管理员后台</h2>
		<p id="page-intro">这是一个管理界面。</p>

		<div class="clear"></div>
		<div class="content-box">
			<div class="content-box-header">
				<h3>发布文章</h3>
				<ul class="content-box-tabs">
				</ul>
				<div class="clear"></div>
			</div>
			<div class="content-box-content">

				<#if rtMsg??>
				<div class="notification attention png_bg">
					<a href="#" class="close"><img
						src="${webroot}/freemarker/themes/admin/img/icons/cross_grey_small.png"
						title="Close this notification" alt="close" /></a>
					<div id="editNoteHint">${rtMsg}</div>
				</div>
				</#if>




				<div class="tab-content default-tab" id="tab1">
					<form action="${webroot}/back/article/addArticle.html"
						 method="post" enctype="multipart/form-data">
						<input type="hidden" name="status" id="status" value="add" />
						
						<fieldset>
							<p>
								<div style="float: right;">
									<input id="create" style="display: none;" class="button" type="button" onclick="createEditor()" value="创建编辑器" /> 
									<input id="delete" class="button" type="button"	onclick="deleteEditor()" value="删除编辑器" />
									<input class="button" type="button"  value="发布" />	
								</div>
							</p>
							<p>
								<label>添加标题</label> <input
									class="text-input medium-input datepicker" type="text"
									id="medium-input" name="title" />
							</p>
							<br />

							<p>
								<label>选择栏目</label> <select name="siteid" class="small-input">
									<#list secListSiteList as secListSite>
									<option value="${secListSite.id }">${secListSite.name}</option> </#list>

								</select>
							</p>
							
							<p>
								<label>展示图片</label>
								<input type="file"  name="imgfile" >
							</p>

							<p>
								<label>添加内容</label>
								<script id="editor" name="content" type="text/plain"
									style="width:100%;height:500px;"></script>
							</p>
						
							<script type="text/javascript">
								//实例化编辑器
								//建议使用工厂方法getEditor创建和引用编辑器实例，如果在某个闭包下引用该编辑器，直接调用UE.getEditor('editor')就能拿到相关的实例
								var ue = UE.getEditor('editor');

								function deleteEditor() {
									UE.getEditor('editor').destroy();
									$('editor').attr("name", "content");
									$('#create').show();
									$('#delete').hide();
								}
								function createEditor() {
									UE.getEditor('editor');
									$('#delete').show();
									$('#create').hide();
								}
							</script>
							
							
						</fieldset>
						<div class="clear"></div>
					</form>
				</div>
				<!-- End #tab2 -->
			</div>
			<!-- End .content-box-content -->
		</div>
		<!-- End .content-box -->
		<div class="content-box column-left">
			<!-- End .content-box-header -->

			<!-- End .content-box-content -->
		</div>
		<!-- End .content-box -->

		<div class="clear"></div>
		
		<input type="file" name="file_upload" id="uploadify" />  
		<script type="text/javascript">  
$(function() {  
    $('#uploadify').uploadify({  
        //是否自动上传  
        'auto' : false,  
        //按钮相关样式  
        //'buttonClass' : 'class',  
        'buttonCursor' : 'hand',  
        //'buttonImage' : '',  
        'buttonText' : '选择文件',  
        'height' : 30,  
        'width' : 100,  
        //检查是否有已存在的文件  
        //'checkExisting' : '',  
        //显示debug信息  
        'debug' : true,  
        //file相关  
        'multi' : false,  
        'fileObjName' : 'theFile',  
        //'fileSizeLimit' : '100B, KB, MB, or GB',  
        //'fileTypeDesc' : '描述文件类型',  
        //'fileTypeExts' : '*.gif; *.jpg; *.png',  
        //表单数据  
        //'method' : 'post',  
        //'formData'     : {'someKey' : 'someValue', 'someOtherKey' : 1},  
        //'onUploadStart' : function(file) {  
          //  $("#file_upload").uploadify("settings", "someOtherKey", 2);  
        //},  
        //上传是下面那个进度条  
        //'itemTemplate' : 'html code use instanceId,fileId,fileName,fileSize',  
        //覆盖默认的事件，声明哪些事件会被覆盖  
        //'overrideEvents' : ['',''],  
        //防止缓存  
        //'preventCaching' : true,  
        //显示进度  
        //'progressData' : 'percentage,speed',  
        //指定文件队列的domId  
        //'queueID'  : 'some_file_queue',  
        //一次可以往队列添加多少文件  
        //'queueSizeLimit' : 123,  
        //上传完成的文件是否自定隐藏显示  
        //'removeCompleted' : false,  
        //移除上传完成文件的时间，单位s  
        //'removeTimeout' : 10,  
        //上传出错后会多次尝试  
        //'requeueErrors' ： true,  
        //上传完毕后，等待后台返回时间但，单位s  
        //'successTimeout' : 5,  
        //swf  
        'swf' : '/kelidly/uploadify/uploadify.swf',  
        'uploader' : 'uploadFile111.jsp'  
        //处理文件的上传  
        //'uploader' : '<%=path%>/assignmentAction!test.action',  
        //同时上传文件个数的限定  
        'uploadLimit' : 1  
    });  
});  
</script> 
		
		
		
		
<!-- 							<p>
								<label>flash上传</label>
								<input type="hidden" value="" id="flashurl" name="flashurl"></input>
				<form id="uploadForm" action='${webroot}/back/article/addSwfFiles.html' method="post" enctype="multipart/form-data">
						
						<div class="upload_box">
                        <div class="upload_main">
                            <div class="upload_choose">
                                <input id="fileselect" type="file" size="30" name="fileselect" multiple />
                                <span id="fileDragArea" class="upload_drag_area">或者将文件拖到此处</span>
                            </div>
                            <div id="preview" class="upload_preview"></div>
                        </div>
                        <div class="upload_submit">
                        
                        <button type="button" id="fileSubmit" class="upload_submit_btn">确认上传文件</button>
                        </div>
                        <div id="uploadInf" class="upload_inf"></div>
                    </div>
                    </form>
							</p> -->
<!-- <script>		

var arrFiles = [];
var params = {
	fileInput: $("#fileselect").get(0),
	dragDrop: $("#fileDragArea").get(0),
	upButton: $("#fileSubmit").get(0),
	url: $("#uploadForm").attr("action"),
	filter: function(files) {
		
		for (var i = 0, file; file = files[i]; i++) {
			if (file.type.indexOf("image") == 0 || file.type.indexOf("application/x-shockwave-flash") == 0
			|| file.type.indexOf("text/xml") == 0) {
				if (file.size >= 1024000) {
					alert('您这张"'+ file.name +'"文件大小过大，应小于1M');	
				} else {
					arrFiles.push(file);	
				}			
			}else {
				alert('文件"' + file.name + '"不是图片,swf,xml格式。');	
			}
		}
		return arrFiles;
	},
	onSelect: function(files) {
		var html = '', i = 0;
		$("#preview").html('<div class="upload_loading"></div>');
		var funAppendImage = function() {
			file = files[i];
			if (file) {
				var reader = new FileReader()
				reader.onload = function(e) {
					html = html + '<div id="uploadList_'+ i +'" class="upload_append_list"><p><strong>' + file.name + '</strong>'+ 
						'<a href="javascript:" class="upload_delete" title="删除" data-index="'+ i +'">删除</a><br />' +
						
						'<span id="uploadProgress_' + i + '" class="upload_progress"></span>' +
					'</div>';
					
					i++;
					funAppendImage();
				}
				reader.readAsDataURL(file);
			} else {
				$("#preview").html(html);
				if (html) {
					//删除方法
					$(".upload_delete").click(function() {
						ZXXFILE.funDeleteFile(files[parseInt($(this).attr("data-index"))]);
						return false;	
					});
					//提交按钮显示
					$("#fileSubmit").show();	
				} else {
					//提交按钮隐藏
					$("#fileSubmit").hide();	
				}
			}
		};
		funAppendImage();		
	},
	onDelete: function(file) {
		$("#uploadList_" + file.index).fadeOut(10);
		ZXXFILE.fileFilter.pop(file);
	},
	onDragOver: function() {
		$(this).addClass("upload_drag_hover");
	},
	onDragLeave: function() {
		$(this).removeClass("upload_drag_hover");
	},
	onProgress: function(file, loaded, total) {
		var eleProgress = $("#uploadProgress_" + file.index), percent = (loaded / total * 100).toFixed(2) + '%';
		eleProgress.show().html(percent);
	},
	onSuccess: function(file, response) {
		$("#uploadInf").append("<p>上传成功，文件地址是：" + response + "</p>");
		$("#flashurl").val(response);
	},
	onFailure: function(file) {
		$("#uploadInf").append("<p>文件" + file.name + "上传失败！</p>");	
		$("#uploadImage_" + file.index).css("opacity", 0.2);
	},
	onComplete: function() {
		//提交按钮隐藏
		$("#fileSubmit").hide();
		//file控件value置空
		$("#fileselect").val("");
		$("#uploadInf").append("<p>当前文件全部上传完毕，可继续添加上传。</p>");
	}
};
ZXXFILE = $.extend(ZXXFILE, params);
ZXXFILE.init();
</script> -->
		<!-- End Notifications -->
		<#include "../include/footer.html">
	</div>

</body>
</html>
